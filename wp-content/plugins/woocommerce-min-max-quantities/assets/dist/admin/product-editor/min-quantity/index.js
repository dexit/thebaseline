(()=>{"use strict";const t=window.wp.blocks,e=window.React,i=window.wc.blockTemplates,n=window.wp.element,a=window.wc.productEditor,o=window.wp.i18n;function r(t,e){return e>0&&(t%e!=0||0===t)}function m(t){return parseFloat(t||"0")}function u(t){return t||""}const s=window.wp.data;const l=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"woocommerce-min-max/min-quantity-field","version":"0.1.0","title":"Minimum Quantity","category":"widgets","icon":"flag","description":"Minimum Quantity","attributes":{"label":{"type":"string","__experimentalRole":"content"}},"supports":{"html":false,"inserter":false},"textdomain":"woocommerce-min-max-quantities","editorScript":"file:./index.js","editorStyle":"file:./index.css","style":"file:./style-index.css"}');(0,t.registerBlockType)(l,{edit:function({attributes:t}){const l=(0,i.useWooBlockProps)(t),[c,d]=(0,a.__experimentalUseProductEntityProp)("meta_data.minimum_allowed_quantity"),[_]=(0,a.__experimentalUseProductEntityProp)("meta_data.maximum_allowed_quantity"),{groupOf:p,isCategoryGroupOf:y}=function(){const[t]=(0,a.__experimentalUseProductEntityProp)("categories"),e=(0,s.useSelect)((e=>e("core").getEntityRecords("taxonomy","product_cat",{include:t?.map((t=>t.id))})||[]),[t]),[i]=(0,a.__experimentalUseProductEntityProp)("meta_data.group_of_quantity"),n=Math.min(...e.filter((t=>""!==t.meta?.group_of_quantity)).map((t=>parseFloat(t.meta?.group_of_quantity||"0")))),o=n&&n!==1/0&&!i;return{groupOf:i&&String(i||"")||o&&String(n)||"1",isCategoryGroupOf:o}}(),{error:f}=(0,a.useValidation)("meta_data.minimum_allowed_quantity_on_save",(async function(){if(m(c)<0)return(0,o.sprintf)(
// translators: %d is the minimum value of the number input.
(0,o.__)("Value must be greater than or equal to %d","woocommerce-min-max-quantities"),0)}),[c]),{error:w,validate:g}=(0,a.useValidation)("minimum_allowed_quantity_on_change",(async function(t,e){return function(t,e,i,n){if("min"===n?t:e)return t&&e&&m(t)>m(e)?"min"===n?(0,o.sprintf)(
// translators: %d is the value of the max quantity.
(0,o.__)("This must be lower than or equal to %d (your max. quantity).","woocommerce-min-max-quantities"),m(e)):(0,o.sprintf)(
// translators: %d is the value of the min quantity.
(0,o.__)("This must be higher than or equal to %d (your min. quantity).","woocommerce-min-max-quantities"),m(t)):function(t,e){if(t&&r(m(t),m(e)))return(0,o.sprintf)(
// translators: %d is the value of the groupOf quantity input.
(0,o.__)("Please enter an integer multiple of %d","woocommerce-min-max-quantities"),e)}("min"===n?t:e,i)}("string"==typeof e?.minimumQuantity?e.minimumQuantity:c,"string"==typeof e?.maximumQuantity?e.maximumQuantity:_,p,"min")}),[c,_,p]),q=function(t){const{updateMetadata:e}=(0,a.__experimentalUseProductMetadata)();return(i,n,a,o)=>{const u=[];let s=i;(n&&"minimum_allowed_quantity"===o?m(s)>m(n):m(s)<m(n))?(s=n,u.push({key:o,value:n})):r(m(i),m(a))&&(s=function(t,e){const i=Math.ceil(t/e)*e,n=Math.floor(t/e)*e;return Math.abs(i-t)>Math.abs(n-t)?n:i}(m(i),m(a)).toString(),u.push({key:o,value:s})),u.length&&e(u),t({minimumQuantity:"minimum_allowed_quantity"===o?s:n,maximumQuantity:"maximum_allowed_quantity"===o?s:n})}}(g);return(0,n.useEffect)((()=>{g()}),[p]),(0,e.createElement)("div",{...l},(0,e.createElement)(a.__experimentalNumberControl,{...t,onChange:t=>{d(t),g({minimumQuantity:t})},value:u(c),error:f||w,onBlur:()=>{c&&q(c,_,p,"minimum_allowed_quantity")},step:m(p),placeholder:y?(0,o.sprintf)(
// translators: %d is the value of the category group of quantity.
(0,o.__)("%d (category default)","woocommerce-min-max-quantities"),m(p)):(0,o.sprintf)(
// translators: %d is the value of the category group of quantity.
(0,o.__)("%d (default)","woocommerce-min-max-quantities"),m(p)),tooltip:(0,o.__)("Enter a minimum quantity customers can buy in a single order. This is particularly useful for items sold in larger quantities, like multipacks.","woocommerce-min-max-quantities")}))}})})();