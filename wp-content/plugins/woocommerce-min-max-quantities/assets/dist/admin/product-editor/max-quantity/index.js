(()=>{"use strict";const t=window.wp.blocks,e=window.React,i=window.wc.blockTemplates,n=window.wp.element,a=window.wc.productEditor,o=window.wp.i18n;function m(t,e){return e>0&&(t%e!=0||0===t)}function r(t){return parseFloat(t||"0")}function u(t){return t||""}const s=window.wp.data;const l=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"woocommerce-min-max/max-quantity-field","version":"0.1.0","title":"Maximum Quantity","category":"widgets","icon":"flag","description":"Maximum Quantity","attributes":{"label":{"type":"string","__experimentalRole":"content"}},"supports":{"html":false,"inserter":false},"textdomain":"woocommerce-min-max-quantities","editorScript":"file:./index.js","editorStyle":"file:./index.css","style":"file:./style-index.css"}');(0,t.registerBlockType)(l,{edit:function({attributes:t}){const l=(0,i.useWooBlockProps)(t),[c,d]=(0,a.__experimentalUseProductEntityProp)("meta_data.maximum_allowed_quantity"),[p]=(0,a.__experimentalUseProductEntityProp)("meta_data.minimum_allowed_quantity"),{groupOf:_}=function(){const[t]=(0,a.__experimentalUseProductEntityProp)("categories"),e=(0,s.useSelect)((e=>e("core").getEntityRecords("taxonomy","product_cat",{include:t?.map((t=>t.id))})||[]),[t]),[i]=(0,a.__experimentalUseProductEntityProp)("meta_data.group_of_quantity"),n=Math.min(...e.filter((t=>""!==t.meta?.group_of_quantity)).map((t=>parseFloat(t.meta?.group_of_quantity||"0")))),o=n&&n!==1/0&&!i;return{groupOf:i&&String(i||"")||o&&String(n)||"1",isCategoryGroupOf:o}}(),{error:y,validate:f}=(0,a.useValidation)("meta_data.maximum_allowed_quantity_on_change",(async function(t,e){const i="string"==typeof e?.maximumQuantity?e.maximumQuantity:c;return function(t,e,i,n){if("min"===n?t:e)return t&&e&&r(t)>r(e)?"min"===n?(0,o.sprintf)(
// translators: %d is the value of the max quantity.
(0,o.__)("This must be lower than or equal to %d (your max. quantity).","woocommerce-min-max-quantities"),r(e)):(0,o.sprintf)(
// translators: %d is the value of the min quantity.
(0,o.__)("This must be higher than or equal to %d (your min. quantity).","woocommerce-min-max-quantities"),r(t)):function(t,e){if(t&&m(r(t),r(e)))return(0,o.sprintf)(
// translators: %d is the value of the groupOf quantity input.
(0,o.__)("Please enter an integer multiple of %d","woocommerce-min-max-quantities"),e)}("min"===n?t:e,i)}("string"==typeof e?.minimumQuantity?e.minimumQuantity:p,i,_,"max")}),[c,p,_]),w=function(t){const{updateMetadata:e}=(0,a.__experimentalUseProductMetadata)();return(i,n,a,o)=>{const u=[];let s=i;(n&&"minimum_allowed_quantity"===o?r(s)>r(n):r(s)<r(n))?(s=n,u.push({key:o,value:n})):m(r(i),r(a))&&(s=function(t,e){const i=Math.ceil(t/e)*e,n=Math.floor(t/e)*e;return Math.abs(i-t)>Math.abs(n-t)?n:i}(r(i),r(a)).toString(),u.push({key:o,value:s})),u.length&&e(u),t({minimumQuantity:"minimum_allowed_quantity"===o?s:n,maximumQuantity:"maximum_allowed_quantity"===o?s:n})}}(f);return(0,n.useEffect)((()=>{f()}),[_]),(0,e.createElement)("div",{...l},(0,e.createElement)(a.__experimentalNumberControl,{...t,onChange:t=>{d(t),f({maximumQuantity:t})},value:u(c),error:y,step:r(_),onBlur:()=>{c&&w(c,p,_,"maximum_allowed_quantity")},placeholder:(0,o.__)("No limit","woocommerce-min-max-quantities"),tooltip:(0,o.__)("Enter a maximum quantity customers can buy in a single order. This is particularly useful for items that have limited quantity, like art or handmade goods.","woocommerce-min-max-quantities")}))}})})();